{% extends "web/app/app_base.html" %}
{% load i18n %}
{% load static %}
{% block app %}

<div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4">Connected Accounts for Case: {{ case.name }}</h1>

    <!-- Return to Case Link -->
    <div class="mb-4">
        <a href="{% url 'case:case_detail' slug=case.slug %}" class="btn btn-secondary">Return to Case</a>
    </div>

    <div class="mb-4">
        <a href="{% url 'case:connect_client' slug=case.slug %}" class="btn btn-primary">Connect Another Account</a>
    </div>

    <!-- AWS Accounts -->
    <h2 class="text-xl font-semibold mt-6">AWS Accounts</h2>
    {% if aws_accounts %}
    <table class="table w-full">
        <thead>
            <tr>
                <th>Account ID</th>
                <th>Region</th>
                <th>Added By</th>
                <th>Added At</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for account in aws_accounts %}
            <tr>
                <td>
                    <a href="{% url 'aws:list_aws_resources' account.id %}" class="text-blue-600 hover:underline">
                        {{ account.account_id }}
                    </a>
                </td>
                <td>{{ account.aws_region }}</td>
                <td>{{ account.added_by.username }}</td>
                <td>{{ account.added_at|date:"Y-m-d H:i" }}</td>
                <td>
                    {% if account.validated %}
                    <span class="badge badge-success">Validated</span>
                    {% else %}
                    <span class="badge badge-error">Not Validated</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'aws:edit_account' account.id %}" class="btn btn-secondary btn-sm">Edit</a>
                    <button 
                        class="btn btn-error btn-sm"
                        onclick="if(confirm('Are you sure you want to delete this account? This action cannot be undone.')) { window.location.href='{% url 'aws:delete_account' account.id %}'; }">
                        Delete
                    </button>
                    <a href="{% url 'aws:pull_aws_resources' account.id %}" class="btn btn-primary btn-sm">
                        Pull Resources
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-gray-600">No AWS accounts connected yet.</p>
    {% endif %}

    <!-- GCP Placeholder -->
    <h2 class="text-xl font-semibold mt-6">GCP Accounts</h2>
    {% if gcp_placeholder %}
    <p class="text-gray-600">GCP integration coming soon.</p>
    {% endif %}

    <!-- Azure Placeholder -->
    <h2 class="text-xl font-semibold mt-6">Azure Accounts</h2>
    {% if azure_placeholder %}
    <p class="text-gray-600">Azure integration coming soon.</p>
    {% endif %}
</div>

{% endblock %}
